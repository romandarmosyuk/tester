<h2>Личный кабинет</h2>

<div class="profile-info" *ngIf="userId; else guest">
  <p><strong>Email:</strong> {{ email }}</p>

  <div class="username">
    <ng-container *ngIf="!editingName; else editName">
      <p><strong>Имя:</strong> {{ username || 'Не указано' }}</p>
      <button class="profile-button" (click)="editingName = true">
        Редактировать имя
      </button>
    </ng-container>

    <ng-template #editName>
      <input [(ngModel)]="username" placeholder="Введите имя" name="username" />
      <button class="profile-button" (click)="saveUsername()">Сохранить</button>
      <button class="profile-button" (click)="editingName = false">
        Отмена
      </button>
    </ng-template>
  </div>
  <button class="profile-button" (click)="logout()">Выйти</button>

  <h3>История попыток:</h3>
  <ul class="history">
    <li *ngFor="let a of attempts">
      <strong>Попытка от {{ formatDate(a.createdAt) }}</strong> — результат:
      {{ a.score }}/{{ a.total }}
      <button class="profile-button" (click)="viewAttempt(a.id)">
        Посмотреть
      </button>
    </li>
  </ul>
</div>

<ng-template #guest>
  <p>Вы не авторизованы. <a routerLink="/login">Войти</a></p>
</ng-template>
